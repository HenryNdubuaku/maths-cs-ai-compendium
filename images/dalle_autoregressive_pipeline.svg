<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 280" width="800" height="280">
  <defs>
    <marker id="arr" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#333"/>
    </marker>
    <marker id="arr-purple" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#9b59b6"/>
    </marker>
    <marker id="arr-blue" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#3498db"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="400" y="22" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">DALL-E: Autoregressive Image Generation</text>

  <!-- Text tokens (red squares) -->
  <text x="45" y="58" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#e74c3c">Text Tokens</text>
  <rect x="15" y="66" width="28" height="28" rx="4" fill="#e74c3c" fill-opacity="0.15" stroke="#e74c3c" stroke-width="1.2"/>
  <text x="29" y="84" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#e74c3c">a</text>
  <rect x="47" y="66" width="28" height="28" rx="4" fill="#e74c3c" fill-opacity="0.15" stroke="#e74c3c" stroke-width="1.2"/>
  <text x="61" y="84" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#e74c3c">cat</text>
  <rect x="79" y="66" width="28" height="28" rx="4" fill="#e74c3c" fill-opacity="0.15" stroke="#e74c3c" stroke-width="1.2"/>
  <text x="93" y="84" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#e74c3c">on</text>
  <rect x="111" y="66" width="28" height="28" rx="4" fill="#e74c3c" fill-opacity="0.15" stroke="#e74c3c" stroke-width="1.2"/>
  <text x="125" y="84" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#e74c3c">mat</text>

  <!-- Image tokens (blue squares) -->
  <text x="205" y="58" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#3498db">Image Tokens</text>
  <rect x="155" y="66" width="28" height="28" rx="4" fill="#3498db" fill-opacity="0.15" stroke="#3498db" stroke-width="1.2"/>
  <text x="169" y="84" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#3498db">42</text>
  <rect x="187" y="66" width="28" height="28" rx="4" fill="#3498db" fill-opacity="0.15" stroke="#3498db" stroke-width="1.2"/>
  <text x="201" y="84" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#3498db">17</text>
  <rect x="219" y="66" width="28" height="28" rx="4" fill="#3498db" fill-opacity="0.15" stroke="#3498db" stroke-width="1.2"/>
  <text x="233" y="84" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#3498db">91</text>
  <rect x="251" y="66" width="28" height="28" rx="4" fill="#3498db" fill-opacity="0.15" stroke="#3498db" stroke-width="1.2"/>
  <text x="265" y="84" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#3498db">...</text>
  <rect x="283" y="66" width="28" height="28" rx="4" fill="#3498db" fill-opacity="0.15" stroke="#3498db" stroke-width="1.2"/>
  <text x="297" y="84" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#3498db">?</text>

  <!-- Concatenation bracket -->
  <text x="165" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">concatenated sequence</text>
  <line x1="15" y1="100" x2="310" y2="100" stroke="#ccc" stroke-width="1" stroke-dasharray="3,2"/>

  <!-- Arrow down to transformer -->
  <line x1="165" y1="118" x2="165" y2="138" stroke="#333" stroke-width="1.2" marker-end="url(#arr)"/>

  <!-- Transformer Decoder -->
  <rect x="70" y="140" width="190" height="55" rx="8" fill="#9b59b6" fill-opacity="0.12" stroke="#9b59b6" stroke-width="1.5"/>
  <text x="165" y="163" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#9b59b6">Transformer Decoder</text>
  <text x="165" y="180" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">12B parameters, causal attention</text>

  <!-- Autoregressive arrow (curved, looping) -->
  <path d="M260,167 C290,167 290,130 310,100 C320,85 310,75 297,80" fill="none" stroke="#9b59b6" stroke-width="1.2" stroke-dasharray="4,2" marker-end="url(#arr-purple)"/>
  <text x="318" y="130" text-anchor="start" font-family="Arial, sans-serif" font-size="8" fill="#9b59b6">predict next</text>
  <text x="318" y="140" text-anchor="start" font-family="Arial, sans-serif" font-size="8" fill="#9b59b6">image token</text>

  <!-- Arrow from transformer to predicted tokens -->
  <line x1="165" y1="195" x2="165" y2="215" stroke="#333" stroke-width="1.2" marker-end="url(#arr)"/>

  <!-- Predicted image tokens row -->
  <text x="165" y="233" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Predicted image token sequence (1024 tokens)</text>

  <!-- Predicted tokens -->
  <rect x="70" y="240" width="22" height="22" rx="3" fill="#3498db" fill-opacity="0.25" stroke="#3498db" stroke-width="1"/>
  <rect x="96" y="240" width="22" height="22" rx="3" fill="#3498db" fill-opacity="0.25" stroke="#3498db" stroke-width="1"/>
  <rect x="122" y="240" width="22" height="22" rx="3" fill="#3498db" fill-opacity="0.25" stroke="#3498db" stroke-width="1"/>
  <rect x="148" y="240" width="22" height="22" rx="3" fill="#3498db" fill-opacity="0.25" stroke="#3498db" stroke-width="1"/>
  <rect x="174" y="240" width="22" height="22" rx="3" fill="#3498db" fill-opacity="0.25" stroke="#3498db" stroke-width="1"/>
  <rect x="200" y="240" width="22" height="22" rx="3" fill="#3498db" fill-opacity="0.25" stroke="#3498db" stroke-width="1"/>
  <rect x="226" y="240" width="22" height="22" rx="3" fill="#3498db" fill-opacity="0.25" stroke="#3498db" stroke-width="1"/>
  <text x="260" y="255" text-anchor="start" font-family="Arial, sans-serif" font-size="10" fill="#3498db">...</text>

  <!-- Arrow to dVAE Decoder -->
  <line x1="280" y1="251" x2="410" y2="251" stroke="#333" stroke-width="1.2" marker-end="url(#arr)"/>

  <!-- dVAE Decoder -->
  <rect x="420" y="125" width="140" height="50" rx="8" fill="#27ae60" fill-opacity="0.12" stroke="#27ae60" stroke-width="1.5"/>
  <text x="490" y="148" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#27ae60">dVAE Decoder</text>
  <text x="490" y="163" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">8192-vocab codebook</text>

  <!-- Arrow connecting predicted tokens to dVAE -->
  <line x1="310" y1="251" x2="420" y2="160" stroke="#333" stroke-width="1.2" marker-end="url(#arr)"/>

  <!-- Arrow from dVAE to image -->
  <line x1="560" y1="150" x2="610" y2="150" stroke="#333" stroke-width="1.2" marker-end="url(#arr)"/>

  <!-- Output image placeholder -->
  <rect x="620" y="100" width="100" height="100" rx="8" fill="#3498db" fill-opacity="0.08" stroke="#3498db" stroke-width="1.5"/>
  <!-- Simple cat silhouette hint -->
  <text x="670" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#3498db">Generated</text>
  <text x="670" y="158" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#3498db">Image</text>
  <text x="670" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#999">256 x 256</text>

  <!-- Stage labels at bottom -->
  <text x="165" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#999">Stage 1: Autoregressive token prediction</text>
  <text x="560" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#999">Stage 2: Token-to-pixel decoding</text>
</svg>