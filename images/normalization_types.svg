<svg width="700" height="320" xmlns="http://www.w3.org/2000/svg">
  <text x="350" y="22" fill="#333" font-size="14" font-weight="bold" text-anchor="middle">Normalization Types: Which Dimensions to Normalize Over</text>

  <!-- Tensor labels -->
  <text x="90" y="50" fill="#666" font-size="11" text-anchor="middle">Batch (N)</text>
  <text x="350" y="50" fill="#666" font-size="11" text-anchor="middle">Channels (C)</text>
  <text x="580" y="50" fill="#666" font-size="11" text-anchor="middle">Spatial (H, W)</text>

  <!-- === Batch Norm === -->
  <text x="175" y="80" fill="#3498db" font-size="12" font-weight="bold" text-anchor="middle">BatchNorm</text>

  <!-- Grid: 4 rows (batch) x 3 cols (channels), cells represent spatial -->
  <!-- Highlight column (same channel across batch) -->
  <rect x="130" y="90" width="30" height="130" fill="#3498db" opacity="0.2" rx="2"/>
  <!-- Row 1 -->
  <rect x="100" y="90" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="130" y="90" width="30" height="30" rx="2" fill="none" stroke="#3498db" stroke-width="1.5"/>
  <rect x="160" y="90" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <!-- Row 2 -->
  <rect x="100" y="122" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="130" y="122" width="30" height="30" rx="2" fill="none" stroke="#3498db" stroke-width="1.5"/>
  <rect x="160" y="122" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <!-- Row 3 -->
  <rect x="100" y="154" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="130" y="154" width="30" height="30" rx="2" fill="none" stroke="#3498db" stroke-width="1.5"/>
  <rect x="160" y="154" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <!-- Row 4 -->
  <rect x="100" y="186" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="130" y="186" width="30" height="30" rx="2" fill="none" stroke="#3498db" stroke-width="1.5"/>
  <rect x="160" y="186" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>

  <text x="175" y="235" fill="#3498db" font-size="10" text-anchor="middle">normalise across batch</text>
  <text x="175" y="248" fill="#3498db" font-size="10" text-anchor="middle">per channel</text>

  <!-- === Layer Norm === -->
  <text x="350" y="80" fill="#e74c3c" font-size="12" font-weight="bold" text-anchor="middle">LayerNorm</text>

  <!-- Highlight row (all channels for one sample) -->
  <rect x="275" y="90" width="150" height="30" fill="#e74c3c" opacity="0.2" rx="2"/>
  <!-- Row 1 -->
  <rect x="275" y="90" width="30" height="30" rx="2" fill="none" stroke="#e74c3c" stroke-width="1.5"/>
  <rect x="305" y="90" width="30" height="30" rx="2" fill="none" stroke="#e74c3c" stroke-width="1.5"/>
  <rect x="335" y="90" width="30" height="30" rx="2" fill="none" stroke="#e74c3c" stroke-width="1.5"/>
  <rect x="365" y="90" width="30" height="30" rx="2" fill="none" stroke="#e74c3c" stroke-width="1.5"/>
  <rect x="395" y="90" width="30" height="30" rx="2" fill="none" stroke="#e74c3c" stroke-width="1.5"/>
  <!-- Row 2 -->
  <rect x="275" y="122" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="305" y="122" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="335" y="122" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="365" y="122" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="395" y="122" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <!-- Row 3 -->
  <rect x="275" y="154" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="305" y="154" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="335" y="154" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="365" y="154" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="395" y="154" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <!-- Row 4 -->
  <rect x="275" y="186" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="305" y="186" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="335" y="186" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="365" y="186" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="395" y="186" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>

  <text x="350" y="235" fill="#e74c3c" font-size="10" text-anchor="middle">normalise across features</text>
  <text x="350" y="248" fill="#e74c3c" font-size="10" text-anchor="middle">per sample</text>

  <!-- === Instance Norm === -->
  <text x="560" y="80" fill="#27ae60" font-size="12" font-weight="bold" text-anchor="middle">InstanceNorm</text>

  <!-- Highlight single cell -->
  <rect x="520" y="90" width="30" height="30" fill="#27ae60" opacity="0.2" rx="2"/>
  <!-- Row 1 -->
  <rect x="490" y="90" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="520" y="90" width="30" height="30" rx="2" fill="none" stroke="#27ae60" stroke-width="1.5"/>
  <rect x="550" y="90" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <!-- Row 2 -->
  <rect x="490" y="122" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="520" y="122" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="550" y="122" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <!-- Row 3 -->
  <rect x="490" y="154" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="520" y="154" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="550" y="154" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <!-- Row 4 -->
  <rect x="490" y="186" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="520" y="186" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>
  <rect x="550" y="186" width="30" height="30" rx="2" fill="none" stroke="#999" stroke-width="1"/>

  <text x="560" y="235" fill="#27ae60" font-size="10" text-anchor="middle">normalise spatial dims</text>
  <text x="560" y="248" fill="#27ae60" font-size="10" text-anchor="middle">per sample, per channel</text>

  <!-- Grid axis labels -->
  <text x="70" y="110" fill="#666" font-size="9" text-anchor="end">sample 1</text>
  <text x="70" y="142" fill="#666" font-size="9" text-anchor="end">sample 2</text>
  <text x="70" y="174" fill="#666" font-size="9" text-anchor="end">sample 3</text>
  <text x="70" y="206" fill="#666" font-size="9" text-anchor="end">sample 4</text>

  <!-- Formula -->
  <rect x="150" y="268" width="400" height="42" rx="6" fill="#f5f5f5" stroke="#333" stroke-width="1"/>
  <text x="350" y="286" fill="#333" font-size="11" text-anchor="middle">All types: x_norm = (x - mean) / sqrt(var + epsilon)</text>
  <text x="350" y="302" fill="#666" font-size="10" text-anchor="middle">Then scale and shift: y = gamma * x_norm + beta (learnable)</text>
</svg>